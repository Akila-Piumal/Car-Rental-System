<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cars</title>
    <link rel="icon" href="favIcon.png">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://kit.fontawesome.com/e16bf5be25.css" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Golos+Text:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tilt+Warp&display=swap" rel="stylesheet">
</head>
<body>
<!--<header id="header">-->
<!--    <a href="#" id="logo"><img src="assets/img/rent.png" alt=""></a>-->

<!--    <ul id="navBar">-->
<!--        <li><a href="index.html" class="links">Home</a></li>-->
<!--        <li><a href="#cars" class="links" id="carLink">Cars</a></li>-->
<!--        <li><a href="#contactUs" class="links">Contact Us</a></li>-->
<!--        <li><a href="#signUp" class="links">Sign Up</a></li>-->
<!--        <li><a href="#signIn" class="links">Sign In</a></li>-->
<!--    </ul>-->
<!--</header>-->
<nav class="navbar navbar-expand-lg bg-body-tertiary" id="navBarNew">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">
            <img src="assets/img/rent.png" alt="Logo" width="50" height="40" class="d-inline-block align-text-top">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav " id="navListInCars">
                <li class="nav-item" style="width: 74px">
                    <a class="nav-link" aria-current="page" href="#" id="homeLinkInCars">Home</a>
                </li>
                <li class="nav-item" style="width: 70px">
                    <a class="nav-link active fw-bold" href="cars.html" style="color: #ef6d48">Cars</a>
                </li>
                <li class="nav-item" style="width: 106px">
                    <a class="nav-link" href="#">Contact Us</a>
                </li>
                <li class="nav-item" id="signInLink" style="width: 73px">
                    <a class="nav-link" href="#">Sign In</a>
                </li>
                <li class="nav-item" id="signUpLink" >
                    <a class="nav-link" href="#">Sign Up</a>
                </li>

            </ul>
        </div>
        <div id="loginImageDiv">
            <img src="assets/img/21-avatar-lineal.gif" alt="Logo" width="40" height="40" class="d-inline-block align-text-top" id="loginImage">
        </div>
        <small class="text-white text-muted" id="userName"></small>

    </div>
</nav>

<main class="d-flex">
    <section id="sideSec" class="mt-5 pt-5 d-flex flex-column align-items-center px-5">
        <h2 id="carsTopic">Our Cars</h2>

        <div id="dropDownSec" class="pt-5">
            <button class="dropbtn py-3 mb-4" id="btnAllCars">All Cars</button>

            <div class="dropdown mb-4">
                <button class="dropbtn py-3">Fuel Type</button>
                <div class="dropdown-content">
                    <a href="#" onclick="setCars('fuelType','Petrol')">Petrol</a>
                    <a href="#" onclick="setCars('fuelType','Diesel')">Diesel</a>
                    <a href="#" onclick="setCars('fuelType','Hybrid')">Hybrid</a>
                    <a href="#" onclick="setCars('fuelType','Electric')">Electric</a>
                </div>
            </div>

            <div class="dropdown mb-4">
                <button class="dropbtn py-3">Brand</button>
                <div class="dropdown-content">
                    <a href="#" onclick="setCars('brand','BMW')">BMW</a>
                    <a href="#" onclick="setCars('brand','Suzuki')">Suzuki</a>
                    <a href="#" onclick="setCars('brand','Audi')">Audi</a>
                    <a href="#" onclick="setCars('brand','Benz')">Benz</a>
                    <a href="#" onclick="setCars('brand','Honda')">Honda</a>
                    <a href="#" onclick="setCars('brand','Mazda')">Mazda</a>
                    <a href="#" onclick="setCars('brand','Mitsubishi')">Mitsubishi</a>
                    <a href="#" onclick="setCars('brand','Nissan')">Nissan</a>
                    <a href="#" onclick="setCars('brand','Toyota')">Toyota</a>
                </div>
            </div>

            <div class="dropdown mb-4">
                <button class="dropbtn py-3">Type</button>
                <div class="dropdown-content">
                    <a href="#" onclick="setCars('type','Luxury')">Luxury</a>
                    <a href="#" onclick="setCars('type','Standard')">Standard</a>
                    <a href="#" onclick="setCars('type','Economy')">Economy</a>
                    <a href="#" onclick="setCars('type','Premium')">Premium</a>
                </div>
            </div>

            <div class="dropdown mb-4">
                <button class="dropbtn py-3">Transmission</button>
                <div class="dropdown-content">
                    <a href="#" onclick="setCars('transmission','Manual')">Manual</a>
                    <a href="#" onclick="setCars('transmission','Auto')">Auto</a>
                </div>
            </div>

            <div class="dropdown mb-4">
                <button class="dropbtn py-3">Passenger Count</button>
                <div class="dropdown-content">
                    <a href="#" onclick="setCars('passengerCount',2)">2</a>
                    <a href="#" onclick="setCars('passengerCount',3)">3</a>
                    <a href="#" onclick="setCars('passengerCount',4)">4</a>
                    <a href="#" onclick="setCars('passengerCount',5)">5</a>
                </div>
            </div>

        </div>

    </section>

    <section id="mainOfCars" class="mt-5 pt-5 d-flex flex-wrap gap-4 mx-5 px-5">

    </section>
</main>


<script src="assets/js/bootstrap.min.js"></script>
<script src="https://kit.fontawesome.com/e16bf5be25.js" crossorigin="anonymous"></script>
<script src="assets/js/jquery-3.6.1.min.js"></script>
<script>

    let baseUrl = "http://localhost:8080/Back_End_war_exploded/";

    window.onload=function (){
        $('#loginImageDiv').css('display','none');

        var loggedUser=sessionStorage.getItem("user");
        let userObject = JSON.parse(loggedUser);

        // log wela innawanm
        if (userObject!=null){
            $('#homeLinkInCars').click(function (){
                window.location.href = "home.html";
            });
            $('#loginImageDiv').css("display","inline-block");
            $('#userName').text(userObject.userDet.name);
            $('#signUpLink').css("display","none");
            $('#signInLink').css("display","none");
            $('#navListInCars').css("margin-left","70vw");
        }else{
            $('#homeLinkInCars').click(function (){
                window.location.href = "Index.html";
            });
        }
    }


    // set all cars in the start
    setAllCars();

    $("#btnAllCars").click(function () {
        setAllCars();
    });

    //Get all the cars details and set
    function setAllCars(){
        $.ajax({
            url: baseUrl + "car",
            method: "get",
            success:function (resp){
                setCarsByBrand(resp.data);
            },
            error:function (error){
                var jsObject = JSON.parse(error.responseText);
                alert(jsObject.message);
            }
        });
    }

    //get the ca details from ajax request
    function setCars(path,param) {

        $.ajax({
            url: baseUrl + "car/"+path+"/"+ param + "",
            method: 'get',
            success: function (resp) {
                alert(resp.message);
                setCarsByBrand(resp.data);
            },
            error: function (error) {
                var jsObject = JSON.parse(error.responseText);
                alert(jsObject.message);
            }
        });
    }

    // set Cars to the divs
    function setCarsByBrand(data) {
        $("#mainOfCars").empty();
        for (var car of data) {
            $("#mainOfCars").append(`
                    <div id="carDiv" class="">
                        <div id="box-img">
                            <img src="assets/img/car1.jpg" alt="">
                        </div>
                        <p id="carType">` + car.type + `</p>
                        <h2 id="carName">` + car.name + `</h2>
                        <h4 id="priceLabel">` + car.dailyRate + ` <span>per day</span></h4>
                        <a href="#" class="btn" id="btnRentOnCars">Rent Now</a>
                    </div>
        `);
        }
    }

</script>
</body>
</html>